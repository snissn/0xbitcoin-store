<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>0xBitcoin.Store Buy 0xBitcoin with Ethereum</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="vendor/simple-line-icons/css/simple-line-icons.css">
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">


    <!-- Plugin CSS -->
    <link rel="stylesheet" href="device-mockups/device-mockups.min.css">

    <!-- Custom styles for this template -->
    <link href="css/new-age.min.css" rel="stylesheet">

  </head>

  <body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top"><span style="font-family:Open Sans">0</span>xBitcoin.Store</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#buy">Buy</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#mine">Mine</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#discover">Discover</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <header class="masthead" id="buy">
      <div class="container h-100">
        <div class="row h-100">
          <div class="col-lg-7 my-auto">
            <div class="header-content mx-auto">
              <h1 class="mb-5">Buy <span style="font-family:Open Sans">0</span>xBitcoin directly from this <a href="https://etherscan.io/address/0x6c7a3c832e573b1d7f3c9f7d51b2ec13f461dbe1#tokentxns" target=_blank>smart contract</a>.
           </h1>
              <h1 class="mb-5">Own your 0xBitcoin within seconds.
           </h1>
          </div>
          </div>
          <div class="col-lg-5 my-auto">
            <div class="device-container">
                    <img src="https://0xbitcoin.org/app/assets/img/logo.png" class="img-fluid" alt="">
					
                    <div><span id="supply">{loading metamask}</span> 0xBitcoin are in stock</div>

                    <!-- Demo image for screen mockup, you can put an image here, some HTML, an animation, video, or anything else! -->
                    <form id="form_store">
											<div class="form-group">
												<label for="exampleInputEmail1">How many 0xBTC you want to buy</label>
												<input type="input" class="form-control" id="btc_input"  placeholder="0xBTC">
											</div>
											<div class="form-group">
												<label for="exampleInputPassword1">Ethereum Cost </label>
												<input class="form-control" id="eth_input" placeholder="Îž ">
                        <small id="ratio" class="form-text ">
                          500 0xBTC = 1 Eth </p> <!-- todo grab this ratio from the contract -->
                        </small>


											</div>
											<button type="submit" class="btn btn-primary">Purchase</button>
										</form>

            </div>
          </div>
        </div>
      </div>
    </header>

    <section class="cta" id=mine>
      <div class="cta-content">
        <div class="container">
          <h2>Want even more 0xBitcoin?<br>Start mining.</h2>
          <a target=_blank href="http://mike.rs/" class="btn btn-outline btn-xl js-scroll-trigger">Let's Get Started!</a>
        </div>
      </div>
      <div class="overlay"></div>
    </section>


<style>
.badge-link img{
  border-radius:50%;
}
.badges div{
  color:#343a40;
}
.badge-link{padding: 0 25px;padding-top:80px;}
</style>

    <section class="download bg-primary text-center" id="discover">
      <div class="container">
        <div class="row">
          <div class="col-md-8 mx-auto">
            <h2 class="section-heading">Discover what all the buzz is about</h2>
            <div class="badges">
              <a class="badge-link" href="http://reddit.com/r/0xbitcoin"><img src="/img/reddit.png" alt=""><div>Reddit</div></a>
              <a class="badge-link" href="https://discord.gg/JGEqqmS"><img src="/img/discord.png" alt=""><div>Discord</div></a>
              <a class="badge-link" href="https://github.org/0xbitcoin/"><img src="/img/github.png" alt=""><div>Github</div></a>
              <a class="badge-link" href="https://t.me/ZEROxBTC"><img src="/img/telegram.png" alt=""><div>Telegram</div></a>
            </div>
          </div>
        </div>
      </div>
    </section>


    <footer>
      <div class="container">
       <a target=_blank href="http://0xBitcoin.org/">0xBitcoin</a> The only Bitcoin-like token for Ethereum.

          <br>
          The source code is licensed
         <a href="http://opensource.org/licenses/mit-license.php">MIT</a>. The website content
         is licensed <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY NC SA 4.0</a>.
       </p>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/new-age.min.js"></script>
    <script src="contract.js"></script>

    <script>
        function update_form(){
        var btc_val = $("#btc_input").val();
        eth_val = btc_val/500.0; // todo grab this from the contract
        $("#eth_input").val(eth_val);
        }
    function update_stock(first_time){
      var btc_contract = web3.eth.contract(bitcoin_abi)
      var btc_callable = btc_contract.at(bitcoin_address)
      btc_callable.balanceOf(store_address,function(a,b){
        $("#supply").text(b/1E8);
        if(first_time){
          $("#btc_input").val(b/1E8);
          update_form();
        }
      })


    }
    $(function(){
      update_stock(true);
      setInterval(update_stock, 30000);



      $("#btc_input").on("keyup",function(){
        update_form();
      });
      $("#form_store").submit(function(){

        var contract_address = "0x6c7a3c832e573b1d7f3c9f7d51b2ec13f461dbe1"
        var eth_val = $("#eth_input").val()
        var send = web3.eth.sendTransaction({from:web3.eth.coinbase,to:contract_address, value:web3.toWei(eth_val, "ether")}, function(a,b){
          alert("Your payment succeeded!");
          location.href =  "https://etherscan.io/tx/" + b
          });
        return false;
      })



    });

    </script>

  </body>

</html>
